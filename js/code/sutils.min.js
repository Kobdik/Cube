function decodeInt16(e){var n=e.view.getInt16(e.ind);return e.ind+=2,n}function decodeUint16(e){var n=e.view.getUint16(e.ind);return e.ind+=2,n}function decodeUint32(e){var n=e.view.getUint32(e.ind);return e.ind+=4,n}function decodeInt32(e){var n=e.view.getInt32(e.ind);return e.ind+=4,n}function decodeFloat32(e){var n=e.view.getFloat32(e.ind);return e.ind+=4,n}function decodeInt64(e){var n=e.view.getBigInt64(e.ind);return e.ind+=8,n}function decodeDateTime(e){var n=e.view.getBigUint64(e.ind),n=Number(n/1000n+946684800000n);return e.ind+=8,new Date(n)}function decodeDate(e){var n=e.view.getUint32(e.ind),e=(e.ind+=4,864e5*n);return new Date(9466848e5+e)}function decodeString(e){let n="";var t=e.view.getInt32(e.ind);return e.ind+=4,0<t&&(n=e.dec.decode(e.view.buffer.slice(e.ind,e.ind+t)),e.ind+=t),n}function decodeUUID(e){var n=toHexString(e.view.buffer.slice(e.ind,e.ind+16)),t=n.slice(0,8),r=n.slice(8,12),o=n.slice(12,16),d=n.slice(16,20),n=n.slice(20,32);return e.ind+=16,t+`-${r}-${o}-${d}-`+n}function decodeInt32s(n){var t=[],r=n.view.getInt32(n.ind);n.ind+=4;for(let e=0;e<r;e++){var o=n.view.getInt32(n.ind);t.push(o),n.ind+=4}return t}function toHexString(e){e=new Uint8Array(e);return Array.from(e,function(e){return("0"+(255&e).toString(16)).slice(-2)}).join("")}const decoders={decodeInt16:decodeInt16,decodeUint16:decodeUint16,decodeInt32:decodeInt32,decodeInt32s:decodeInt32s,decodeUint32:decodeUint32,decodeFloat32:decodeFloat32,decodeInt64:decodeInt64,decodeDate:decodeDate,decodeDateTime:decodeDateTime,decodeString:decodeString,decodeUUID:decodeUUID},INIT_USER="INIT_USER",ON_ERROR="ON_ERROR",ON_SUCCESS="ON_SUCCESS",INIT_ORDS="INIT_ORDS",INIT_DATA="INIT_DATA",TYPES={INIT_USER:INIT_USER,ON_ERROR:ON_ERROR,ON_SUCCESS:ON_SUCCESS,INIT_ORDS:INIT_ORDS,INIT_DATA:INIT_DATA};function confOrdsResp(e){var n,t,r,o,d;const a=new DataView(e),i={dec:new TextDecoder,ind:0,view:a,tail:()=>a.byteLength-i.ind};console.log(`Conf ords: recieved ${i.tail()} bytes`);for(var s=[];i.tail();)n=decodeInt16(i),t=decodeString(i),d=decodeString(i),r=decodeString(i),o=decodeString(i),s.push({ord:n,tid:t,caption:r,title:o,oper:JSON.parse(d)});return s}function confDataResp(e){var n,t,r,o,d;const a=new DataView(e),i={dec:new TextDecoder,ind:0,view:a,tail:()=>a.byteLength-i.ind};console.log(`Conf data: recieved ${i.tail()} bytes`);for(var s=[];i.tail();)n=decodeString(i),t=decodeString(i),r=decodeString(i),o=decodeString(i),d=Math.round(10*decodeFloat32(i)),s.push({keys:[n,t,r,o],val:d});return s}function onError(e,n,t){return{type:ON_ERROR,err:e,code:n,message:t}}function initOrds(e){return{type:INIT_ORDS,ords:e}}function initData(e){return{type:INIT_DATA,rows:e}}function askBinaryOrdsAsync(){return async n=>fetch("./cashed/ords.dat",{method:"GET",headers:{"Content-Type":"application/octet-stream"}}).then(e=>{if(e.ok)return e.arrayBuffer();throw new Error("binary ords request failed!",{cause:{status:e.status}})}).then(e=>confOrdsResp(e)).then(e=>n(initOrds(e))).catch(e=>n(onError(e,100,"binary ords failed")))}function askBinaryDataAsync(){return async n=>fetch("./cashed/rows.dat",{method:"GET",headers:{"Content-Type":"application/octet-stream"}}).then(e=>{if(e.ok)return e.arrayBuffer();throw new Error("binary data request failed!",{cause:{status:e.status}})}).then(e=>confDataResp(e)).then(e=>n(initData(e))).catch(e=>n(onError(e,100,"binary data failed")))}function askConfOrdsAsync(e=0){return async n=>fetch(`/pf/conf/${e}/ords`).then(e=>{if(e.ok)return e.arrayBuffer();throw new Error("conf ords request failed!",{cause:{status:e.status}})}).then(e=>confOrdsResp(e)).then(e=>n(initOrds(e))).catch(e=>n(onError(e,100,"conf ords failed")))}function askConfDataAsync(e=0){return async n=>fetch(`/pf/conf/${e}/data`).then(e=>{if(e.ok)return e.arrayBuffer();throw new Error("conf data request failed!",{cause:{status:e.status}})}).then(e=>confDataResp(e)).then(e=>n(initData(e))).catch(e=>n(onError(e,100,"conf data failed")))}function askJsonOrdsAsync(){return async n=>fetch("./cashed/ords.json",{method:"GET",headers:{"Content-Type":"application/json"}}).then(e=>{if(e.ok)return e.json();throw new Error("json ords request failed!",{cause:{status:e.status}})}).then(e=>n(initOrds(e))).catch(e=>n(onError(e,100,"json ords failed")))}function askJsonDataAsync(){return async n=>fetch("./cashed/rows.json",{method:"GET",headers:{"Content-Type":"application/json"}}).then(e=>{if(e.ok)return e.json();throw new Error("json rows request failed!",{cause:{status:e.status}})}).then(e=>n(initData(e))).catch(e=>n(onError(e,100,"json data failed")))}const actionCreators={askBinaryOrdsAsync:askBinaryOrdsAsync,askBinaryDataAsync:askBinaryDataAsync,askConfOrdsAsync:askConfOrdsAsync,askConfDataAsync:askConfDataAsync,askJsonOrdsAsync:askJsonOrdsAsync,askJsonDataAsync:askJsonDataAsync};export{decoders,actionCreators,TYPES};